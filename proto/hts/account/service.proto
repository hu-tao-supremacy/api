syntax = "proto3";

package hts.account;


option java_multiple_files = true;
option java_package = "app.onepass.apis";
option java_outer_classname = "AccountProto";
option go_package = "onepass.app/facility/hts/account";

import "hts/common/common.proto";
import "google/protobuf/empty.proto";

message IsAuthenticatedInput {
  string access_token = 1;
}

message UpdateAccountInfoInput {
  hts.common.User user = 1;
}

message UpdateAccountInfoOutput {
  hts.common.User user = 1;
}

message GenerateJWTInput {
  hts.common.User user = 1;
}

message InvalidateJWTInput {
  string access_token = 1;
}

message HasPermissionInput {
  int64 user_id = 1;
  int64 organization_id = 2;
  hts.common.Permission permission_name = 3;
}

service AccountService {
  rpc IsAuthenticated(IsAuthenticatedInput) returns (hts.common.Result);
  rpc UpdateAccountInfo(UpdateAccountInfoInput) returns (UpdateAccountInfoOutput);
  rpc GenerateJWT(GenerateJWTInput) returns (hts.common.Result);
  rpc InvalidateJWT(InvalidateJWTInput) returns (hts.common.Result);
  rpc HasPermission(HasPermissionInput) returns (hts.common.Result);
  rpc ValidatePermission(HasPermissionInput) returns (google.protobuf.Empty);
  rpc Ping(google.protobuf.Empty) returns (hts.common.Result);
}
